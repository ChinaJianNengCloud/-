# 原项目GitHub
https://github.com/Liu-Yicheng/seq2seq_attention-on-picture
# 项目说明
该项目是将多钼靶数据进行二分类(良性和恶性)，多钼靶数据指的是一个病人拥有多张钼靶图片，但是标签只有这个病人的肿瘤是良性和恶性，并没有每张钼靶的标签。其中readme.doc是补充文件

# 项目环境
Pytorch  
keras 
python=3.8 

# 数据以及对应处理说明
原始数据是duocengMUBA_rem,目前以及上传到百度网盘，路径是alist盘sjwlab/chenyinda/project/多层钼靶分类/duocengMUBA_rem.zip。
数据预处理之后的数据名字是dada，目前以及上传到百度网盘，路径是alist盘sjwlab/chenyinda/project/多层钼靶分类/data.zip。

该数据内部有一个xlsx，记录着5033个病人的标签。
由于一开始每个病人的钼靶图片数量不一致，因此需要填补和选择，目前选择的是填补和选择到36张。
填补和选择之后因为存在不同标签的数量差异过大的问题，因此进行了数据增强，5033个数据中，有1356个恶，3677个良。
将数据总量增加到10000，将1356个恶进行数据增强，先水平翻转1356个，之后顺时针旋转90°1356个，最后逆时针旋转90°932个。
良的水平翻转1323个。
提取特征的时候，将每个病人的36张钼靶数据读取并且求均值，转化成一维。


# 程序文件说明
1、extractor.py：使用keras调用inceptionv3从原始图片中提取2048维特征向量   
2、data.py:　　　数据处理程序
3、picture_info：存放label、train、val的信息   
4、config.py:　　记录整个模型的一些超参数   
5、train.py：　　训练程序入口
6、预处理\lowfillto36.py: 将病人的钼靶图片少于36的用同size的全黑的图片填充到36
7、预处理\highdetto36.py: 将病人的钼靶图片多于36的选择前36个图片
8、预处理\dataup.py: 将钼靶图片36张的标签进行数据增强平衡处理，总数为10000

# 项目运行
先对原始数据进行填充和选择代码67，之后进行数据增强代码8。
之后先生成txt文件，之后修改config中的路径，在运行代码1，得到了特征数据之后，运行train即可运行。
